# 遇到的问题和解决方法

##### 如果容器抛以下问题，解决方法是
> [LNVgu_1] bound or publishing to a non-loopback address, enforcing bootstrap checks
> 
> ERROR: [1] bootstrap checks failed
> 
> [1]: max virtual memory areas vm.max_map_count [26200] is too low, increase to at least [262144]

```
# 直接在docker的宿主机运行下面这条命令
sysctl -w vm.max_map_count=262144
sysctl -p
```
```
# elasticsearch有几个垃圾的地方
1) 默认9300端口的监听是只绑定127.0.0.1这块网卡的, 如果要改监听具体IP的网卡或者所有网卡0.0.0.0, 必须配置vm.max_map_count=262144参数, 如果用docker跑, 必须在宿主机运行 sysctl -w vm.max_map_count=262144, 否则es运行就会直接抛错

docker stop single-elasticsearch
docker rm single-elasticsearch
docker network rm elasticsearch-network
docker network create --subnet=10.101.57.0/24 elasticsearch-network
docker run -itd --restart always --net elasticsearch-network --ip 10.101.57.101 -e ES_JAVA_OPTS="-Xms256m -Xmx256m" --name single-elasticsearch elasticsearch:5.6.10
# 不加任何配置参数, 上面的例子是没问题的, 可以正常跑, 如果在最后面加参数, 必须要在宿主机

sysctl -w vm.max_map_count=262144
sysctl -p
# 高版本的elasticsearch是很垃圾的, 相对于低版本来说, 高版本性能提高了, 但是配置向垃圾靠拢了,  
docker stop single-elasticsearch
docker rm single-elasticsearch
docker network rm elasticsearch-network
docker network create --subnet=10.101.57.0/24 elasticsearch-network
docker run -itd --restart always --net elasticsearch-network --ip 10.101.57.101 -e ES_JAVA_OPTS="-Xms256m -Xmx256m" --name single-elasticsearch elasticsearch:5.6.10 -Enetwork.publish_host=0.0.0.0 -Etransport.tcp.port=9300 -Etransport.host=0.0.0.0
```